<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>酒店信息管理</title>
        <meta content="text/html" charset=utf-8>   
        <link href="/css/bootstrap.css" rel="stylesheet" type="text/css" />
        <link href="/css/seller_search_form.css" rel="stylesheet" type="text/css" />
        <link href="/css/style_nomal.css" rel="stylesheet" type="text/css" />
        <link href="/css/tran_history.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="/js/jquery-1.9.1.js"></script>
        <script type="text/javascript" src="/js/bootstrap.js"></script>
        <script type="text/javascript" src="/js/bootstrapex.js"></script> <!-- test -->
    </head>
    <body>
  
  
        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container-fluid">

                    <a class="brand" href="#">Online Payment</a>
                    <div class="nav-collapse collapse">
                        <p class="navbar-text pull-right">
                            Logged in as <a href="#" class="navbar-link">Username</a>
                        </p>
                        <ul class="nav">
                            <li><a href="#">账户设置</a></li>
                            <li><a href="../buyer/order_manage.html">我是买家</a></li>
                            <li class="active"><a href="../seller/order_manage.html">我是卖家</a></li>
		        	        <li><a href="../flight/search.html">淘宝贝</a></li>
			                <li><a href="#contact">在线预订</a></li>
                        </ul>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>
        <div class="hero-unit"></div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span2">
                    <div class="well sidebar-nav">
                        <ul class="nav nav-list">
                            <li class="nav-header">酒店</li>
                            <li class="active"><a href="hotel_manage.html">酒店信息管理</a></li>
                            <li><a href="hotel_manage.html">酒店订单管理</a></li>
                            <li><a href="hotel_manage.html">酒店评论管理</a></li>
                            <li class="nav-header">航班</li>
                            <li><a href="#">航班信息管理</a></li>
                            <li><a href="booking_manage.html">航班订单管理</a></li>
                            <li><a href="comment_manage.html">航班评论管理</a></li>
                        </ul>
                    </div><!--/.well -->
                </div><!--/span-->

                <div class="span8">
                    <div class="row-fluid"> <!-- search panel -->
                        <div class="seller-search-form" id="basicSearch">
                            <div class="row-fluid"> <!-- search inputs -->
                                <table class="grid-form">
                                    <tr>
                                        <td>
                                                <div>
                                                    <label class="search-label">酒店编号</label>
                                                    <input class="search-input" type="text" id="bsHID" placeholder="编号">
                                                </div>
                                        </td>
                                        <td>
                                                <div>
                                                    <label class="search-label">酒店名称</label>
                                                    <input class="search-input" type="date" id="bsName" placeholder="名称">
                                                </div>
                                        </td> <!-- span4 -->
                                        <td>
                                                <div>
                                                    <label class="search-label">酒店位置</label>
                                                    <input class="search-input" type="text" id="bsLocation" placeholder="地点">
                                                </div>
                                        </td> <!-- span4 -->
                                    </tr>
                                </table>
                            </div>
                            
                            <div class="row-fluid"> <!-- buttons -->
                                <div class="grid-form" style="text-align:center;">
                                    <button class="btn" style="width:20%" type="button" id="bsSearch">搜索</button>
                                </div>
                            </div>
                        </div> <!-- seller-search-form -->
                    </div> <!-- row-fluid -->
                    <h3 id="searchVerbose">共有1个搜索结果</h3>
                    <div class="row-fluid"> <!-- search result -->
                        <table class="table table-striped" id="resultTable" style="table-layout:fixed">
                            <colgroup>
                                <col width="25%" />
                                <col width="25%" />
                                <col width="25%" />
                                <col width="25%" />
                            </colgroup>
                            <tr> <!-- header -->
                                <th class="text-cropped">酒店编号</th>
                                <th class="text-cropped">酒店名称</th>
                                <th class="text-cropped">酒店位置</th>
                                <th class="text-cropped">酒店描述</th>
                            </tr>
                            <tr>
                                <td class="text-cropped" rel="popover">tesasdfasdddddddddddddddddddddddddddddddddddddddddddddddddddddddddddt1</td>
                                <td class="text-cropped">abc</td>
                                <td class="text-cropped">def</td>
                                <td class="text-cropped">ghi</td>
                            </tr>
                        </table>
                    </div>
                    <div class="row-fluid"> <!-- add result -->
                        <table class="table" id="addTable" style="table-layout:fixed">
                            <colgroup>
                                <col width="22%" />
                                <col width="22%" />
                                <col width="22%" />
                                <col width="22%" />
                                <col width="6^" />
                            </colgroup>
                            <tr class="warning">
                                <td></td>
                                <td><input class="text-cropped" id="atName" type="text" placeholder="input"></td>
                                <td><input class="text-cropped" id="atDescription" type="text" placeholder="input"></td>
                                <td><input class="text-cropped" id="atLocation" type="text" placeholder="input"></td>
                                <td><button class="btn" id="atAdd">确认</button></td>
                            </tr>
                            <!--<tr class="warning">
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            </tr>
                            <tr class="warning">
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            </tr>
                            <tr class="warning">
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            </tr>
                            <tr class="warning">
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            <td><input type="text" placeholder="input"></td>
                            </tr>-->
                        </table>
                    </div>
                    <div class="row-fluid row-fluid-fix-bottom">
                        <button class="btn" style="width:20%;" type="button">提交更改</button>
                    </div>
                </div> <!-- span10 -->
                
            </div> 
        </div>

        <footer class="tail">
            <hr>
            <a href="">关于我们</a>
            <a href="">合作伙伴</a>
            <a href="">联系客服</a>
            <a href="../other/connect_us.html">联系我们</a>
            <a href="../other/map.html">网站地图</a>
            <span>© 2013 Black.com 版权所有</span>
        </footer>
  
    </body>
  
</html>

<script> // data access
function modify() {
}
</script>

<script> // tools
function checkOverflow(obj) {
    return (obj.prop('scrollWidth') > obj.innerWidth() || obj.text().indexOf('\n') >= 0)
}
</script>

<script> // event handlers
// checks overflow in our one-line context
$('#resultTable').click(function(e) {
    if($(e.target).prop('tagName') == 'INPUT') // avoid re-focusing
        return;
    
    var cell = $(e.target).closest('td');
    if(cell.prop('tagName') == 'TD' && cell.prop('cellIndex') != 0) {
        cell.css('padding', 0);
        
        var text = cell.text();
        cell.html('')
            .append('<input type="text" style="width:90%;margin:0;" value="' + text + '">');
        
        var input = $(cell.children()[0]);
        input.focus().select();
    }
});
$('#resultTable').focusout(function(e){
    var text = $(e.target).val();
    var cell = $(e.target).closest('td');
    cell.css('padding', 8)
        .html(text);
});

$('#bsSearch').click(function(e) {
    $.getJSON(
        '/manage/hotel/async',
        {
            h_id: $('#bsHID').text(),
            name: $('#bsName').text(),
            location: $('#bsLocation').text(),
        },
        function(data) {
            console.log(data);
        });
});

$('#atAdd').click(function(e) {
    var row = $('#addTable tr:first');
    console.log($(row.children()[0]).val());
    $.getJSON(
        '/manage/hotel/async',
        {
            h_id: $($(row.children()[0]).find('input:first')).val(),
            name: $($(row.children()[1]).find('input:first')).val(),
            location: $($(row.children()[2]).find('input:first')).val(),
            description: $($(row.children()[3]).find('input:first')).val(),
            type: 'add',
        },
        function(data) {
            console.log(data);
    });
});

$(function () {
    var edit = false;
    var edittmpl = '<div><textarea style="height:100px">__texthere__</textarea></div>'
        + '<div style="text-align:center;"><button class="btn btn-primary">保存</button>'
        + '<button class="btn">放弃</button></div>';
    var viewtmpl = '<div style="word-wrap:break-word;">__texthere__</div>'

    $("[rel='popover']").popoverex({
        trigger : 'hover', 
        hoverReserve : "in in_popover",
        delay: {show: 100, hide: 1000},
        placement : 'bottom',
        html : true,
        container : 'body',
        content : function() {
            return viewtmpl.replace('__texthere__', $(this).text());
        },
        popover_click: function(e) {
            console.log(edit);
            if(!edit && $(e.target).prop('tagName') != 'BUTTON') {
                edit = true;
                
                var ele = e.data.ele, pop = e.data.pop;
                var popcontent = pop.find('[class=popover-content]');
                ele.popoverex('pin');
                popcontent.html(edittmpl.replace('__texthere__', $(this).text()));
                var textarea = $(popcontent.find('textarea'));
                textarea.focus().select();
                
                // register button events
                var buttons = pop.find('button');
                var ok = $(buttons[0]), cancel = $(buttons[1]);
                var close = function() {
                    buttons.each(function() {
                        $(this).off('click');
                    });
                    ele.popoverex('unpin');
                    ele.popoverex('hide');
                    edit = false;
                    console.log(edit);
                };
                ok.click(function() {
                    // modify()
                    ele.html(textarea.val());
                    close();
                });
                cancel.click(close)
            }
        }
    });
});
</script>